<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>jQuery Mobile: Theme Download</title>
	<link rel="stylesheet" href="themes/taller.min.css" />
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.1/jquery.mobile.structure-1.2.1.min.css" />
	<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.2.1/jquery.mobile-1.2.1.min.js"></script>
	<script src="themes/js/function.js"></script>
	<script>
	
	db = window.openDatabase("DemoSqlStorage", "1.0", "Base de datos de prueba", 5*1024*1024);
		$(document).ready(function(){	
			<!-- cargarCuentas();
			<!-- crearCuenta('cuentaPrueba', 'UYU', 1000); -->
			if (localStorage.userState == "false") {
				redirect('login.html');
			}
			else{
				//aca todo lo demas
				$('#nomUsuario').html(localStorage.userName);
				//chekea si viene de crear una cuenta
				if(localStorage.cuentaNueva == 'true'){
					$('#errorMessage').show().html("<div class='alert alert-danger' role='alert'><strong>Exito!!</strong>la cuenta fue creada</div>");
					localStorage.setItem('cuentaNueva', 'false');
				}
				//CARGA TODAS LAS CUENTAS
				$('#listadoCuentas').html(cargarCuentas(localStorage.userName));
			}
		});
		
		
		
		
		//PRUEBA
		
		function cargarCuentas(){
			db.transaction(function (tx) { 
				tx.executeSql('CREATE TABLE IF NOT EXISTS Cuentas (nombre, moneda, importe)',[],function(tx,results){
					tx.executeSql('select * from Cuentas',[],function(tx,results){
						for(var i = 0; i<results.rows.length;i++)
						{
							console.log(results.rows.item(i).nombre);
							mostrarListaCuentas(results.rows.item(i).nombre);
						}
					});
				});
			});
		}
		
		
		
		function mostrarListaCuentas(nombreCuenta){
			var lista = $('ul:first');
			<!-- listadoCuentas.empty(); -->
			<!-- for(var i = 0; i<resultadoConsulta.results.length;i++){ -->
				<!-- var aux = resultadoConsulta.results[i]; -->
				listadoCuentas.append("<li><a href='#detalle' onclick='#'/><h2>"+nombreCuenta+"</h2><p>"+nombreCuenta+"</p></a></li>");
			
			resultadoConsulta.listview('refresh');
		}
		
		
		
		function crearCuenta(nombreCuenta, monedaCuenta, importeCuenta){
			
			db.transaction(function (tx) { 
			
			 
				tx.executeSql('INSERT INTO Cuentas (nombre, moneda, importe) VALUES (?, ?, ?)',[nombreCuenta, monedaCuenta, importeCuenta],function(){
					alert("Fin!");
				});
			  }
			 );
			
		
		}
		
		
		
	</script>
</head>
<body>
	<div data-role="page" data-theme="a">
		<div data-role="header" data-position="inline">
			
			
			<a class="ui-btn-left ui-btn ui-btn-icon-notext ui-btn-corner-all ui-shadow ui-btn-up-a" data-iconpos="notext" data-theme="a" data-role="button" data-icon="home" title="Back">
				<span class="ui-btn-inner ui-btn-corner-all">
					<span class="ui-btn-text"> Home </span>
					<span data-form="ui-icon" class="ui-icon ui-icon-back ui-icon-shadow"></span>
				</span>
			</a>
			<h1>Cuentas</h1>
			<a class="ui-btn-right ui-btn ui-btn-icon-notext ui-btn-corner-all ui-shadow ui-btn-up-a" data-iconpos="notext" data-theme="a" data-role="button" data-icon="home" title="Home">
				<span class="ui-btn-inner ui-btn-corner-all">
					<span class="ui-btn-text"> Home </span>
					<span data-form="ui-icon" class="ui-icon ui-icon-home ui-icon-shadow"></span>
				</span>
			</a>
		</div>
		<div data-role="content" data-theme="a">
			<div style="display:none" id="errorMessage"></div>
			<p id="nomUsuario">Nombre Usuario</p>
			<hr>
			<p>Seleccione una Cuenta:</p>
			<ul id="listadoCuentas" data-role='listview' data-inset="true">
				<!-- <li>
					<a href='#detalle'><span>Cuenta 1</span></a>
				</li>
				<li>
					<a href='#detalle'><span>Cuenta 2</span></a>
				</li>
				<li>
					<a href='#detalle'><span>Cuenta 3</span></a>
				</li>
				<li>
					<a href='#detalle'><span>Cuenta 4</span></a>
				</li> -->
			</ul>
			<hr>
			<a onclick='redirect("alta-cuenta.html")' data-role='button' >Crear Nueva Cuenta</a>
		</div>
	</div>
</body>
</html>